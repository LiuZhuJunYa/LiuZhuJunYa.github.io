---
title: zkCross：一种新颖的跨链隐私保护审计架构
date: 2025-05-24
tags: 
  - 静态代码分析
  - 区块链
  - 智能合约
  - 以太坊
  - 合约缺陷检测
  - 字节码分析
  - 符号执行
categories: 
  - 论文阅读
---

# zkCross：一种新颖的跨链隐私保护审计架构

## 摘要

区块链研究的重点领域之一是如何在不牺牲系统安全性和可信度的情况下，实现隐私保护审计。然而，同时实现审计和隐私保护这两个看似矛盾的目标具有挑战性，因为审计系统需要透明性和问责制，这可能会引入隐私和安全漏洞。在跨链场景中，来自多个链的信息孤岛进一步使问题复杂化。在本文中，我们确定了跨链隐私保护审计中的三个重要挑战，分别是跨链链接可暴露性（Cross-chain Linkability Exposure, CLE）、隐私与审计的不兼容性（Incompatibility of Privacy and Auditing, IPA）以及全面审计效率低下（Full Auditing Inefficiency, FAI）。为克服这些挑战，我们提出了 zkCross，这是一种新颖的两层跨链架构，配备了三种跨链协议以实现隐私保护的跨链审计。其中两种协议分别为转移和交换提供隐私保护，第三种协议是一种高效的跨链审计协议。这些协议建立在健全的跨链方案之上，以保证隐私保护和审计效率。我们在本地和云服务器上实现了 zkCross，并进行了全面测试，以验证 zkCross 在处理大规模隐私保护审计任务方面的适用性。我们评估了所提协议在运行时间、延迟、吞吐量、Gas 消耗、审计时间和证明大小方面的性能，以展示其可行性。    

## 1 引言

跨链技术 [2] 被视为提升独立区块链系统之间通信和互操作性的有效途径之一。位于不同区块链上的用户可以通过跨链协议实现跨链转移和交换。近期出现了许多跨链协议 [15,30,36,40]，它们主要关注通用性、安全性和效率等方面，却在很大程度上忽略了隐私和审计挑战。这一忽视可能会阻碍跨链机制的广泛应用，并导致严重的安全漏洞、隐私风险，甚至信任与信誉的丧失。

在跨链操作中，隐私保护和审计是两个至关重要的需求。随着人们对数据价值的认识不断加深，对隐私保护的需求也在增长 [23,38]。然而，跨链场景下的隐私考虑不仅需要保护跨区块链传输信息的机密性，还需保护多条链上用户交互的隐私。跨链交互关系的泄露可能导致多种隐私风险，包括追踪资金在链间流转或识别特定交易相关方，从而潜在破坏跨链系统的整体安全性 [6]。此外，审计在跨链场景中同样发挥着重要作用，例如，需要审计以确保存在合作需求但可能存在利益冲突的双方之间交互的正常进行 [22]。

然而，区块链系统中的隐私保护与审计是两个相互冲突的目标：前者要求维护数据机密性并最小化数据暴露，后者则需要透明度和数据访问。因此，同时兼顾隐私保护与审计十分困难，这长期以来已成为单链系统中的重要研究课题 [4,7,9,34,37]。在跨链环境中，这一问题更加严峻。单链系统的设计前提是假设作为区块链节点的审计者可以访问链内所有信息，而多链场景打破了这一前提 —— 某一条链的审计者无法获取其他链上的全部信息。表面上看，审计者可以在所有链上注册账户，但这极为耗费资源且不切实际，尤其是在大规模跨链场景中。例如，比特币和以太坊的账本规模已分别达到 500 GB 和 700 GB，并且持续增长 [17]。这意味着在审计比特币和以太坊时，审计者至少需要 TB 级存储空间，且随着网络中链数量的增加，此需求也随之增长，给审计工作带来显著障碍。因此，单链方案难以直接移植到跨链环境中。

为此，本文首先识别了跨链隐私保护与审计面临的三大关键挑战，并提出可行的解决方案。第一个挑战是跨链可关联性泄露问题（Cross-chain Linkability Exposure, CLE），该问题使对手能够获取跨链交互双方之间的关联性，从而暴露隐私。为解决此问题，需要设计不同跨链活动对应的隐私保护协议，且不得引入可能危及整体区块链系统安全的第三方。第二个挑战是隐私保护与审计的不兼容性（Incompatibility of Privacy and Auditing, IPA），即基于公开可得信息的审计协议必须与针对 CLE 问题的隐私协议保持一致，不产生冲突。第三个挑战是全面审计效率低下问题（Full Auditing Inefficiency, FAI），该问题源于多条异构区块链的存在，可能导致极低的审计效率。这些挑战将在第 3.2 节中详细阐述。

在本文中，我们提出了 zkCross，以有效应对上述三大挑战。具体而言，我们首先设计了一种两层跨链架构：下层包含可相互交互的多条区块链，上层则由审计者组成一条区块链。随后，为解决 CLE 问题，我们基于零知识证明针对两种跨链活动（即跨链转移和跨链交换）提出了两种不同的隐私保护协议，可在无需任何可信第三方的情况下实现隐私保护。最后，为解决 IPA 和 FAI 问题，我们提出了一种跨链审计协议，将审计过程与交易验证过程压缩到新的电路中，从而保证审计者无需获取完整交易内容即可保障审计任务的正确性，并可在常数时间内审核线性增长的交易数量。

zkCross 面向具有跨链互操作性需求的一般区块链系统，适用于无权限和有权限区块链（详见第 2 节）。为方便起见，我们将主要贡献概括如下：
1. zkCross 是首个同时考虑跨链活动隐私保护与审计的跨链方案。据我们所知，目前仅在单链系统中同时兼顾隐私保护与审计的方案，几乎无法直接应用于跨链操作。
2. 我们设计了两层跨链架构，以支持同时实现隐私保护与审计。该架构对审计者友好，可与跨链交互协议解耦，使后者的设计更加灵活。
3. 本文提出了两种跨链隐私保护协议，可保证交互双方的不可关联性，确保跨链交互的原子性，并在无需可信第三方的情况下进一步解决 CLE 问题。
4. 我们设计了一种跨链审计协议，能够有效应对 IPA 和 FAI 挑战，提升上层的审计效率，同时不影响 CLE 问题的解决。
5. 为验证 zkCross 的性能，我们在一条包含 200 个节点的区块链网络上进行了大规模实验，实验结果验证了本设计的有效性与高效性。

本文其余部分结构安排如下：第 2 节介绍相关背景；第 3 节综述最相关的文献并提出三大跨链挑战；第 4 节描述所提方案模型及相关预备知识；第 5 节和第 6 节分别呈现 zkCross 方案的技术细节与安全分析；第 7 节报告 zkCross 的性能评估；第 8 节给出结论与未来研究方向。

## 2 背景

本节提供理解本文工作的必要背景，包括区块链和跨链活动。

### 2.1 区块链

区块链 [32] 是一种共享的分布式账本，用于记录所有交易，并由去中心化网络中的节点维护。每笔交易存储在一个区块中，并按时间顺序链接在一起，因此得名区块链。区块链的关键特性之一是其不可篡改性，这意味着一旦交易被记录，就无法更改。不可篡改性确保了存储于区块链上的数据完整性，使其安全且抗未经授权的修改。此外，区块链消除了交易中介的需求，解决了单点故障的问题。区块链的透明性体现在能够访问所有交易，这与传统银行和服务提供商不向用户开放完整账本的做法形成对比。区块链最初为比特币 [32] 而开发，后逐步演变并应用于多种行业，如金融、物联网、智能电网和供应链管理 [45]。为了适应不同场景，区块链逐渐分化为两种类型：无权限链和有权限链 [38]。无权限链是去中心化网络，任何人都可以加入、参与和验证交易，无需审批；有权限链则是集中或半集中网络，其访问和参与仅限于经批准的实体。

### 2.2 跨链活动

跨链技术促进了两个独立区块链之间的交互 [2]。根据跨链活动的类型，跨链交互可分为跨链转移和跨链交换。跨链转移指资产在两条区块链之间的移动，包括在一条区块链上销毁资产并在另一条区块链上铸造资产的过程。跨链交换则在概念上涉及跨链转移的双向过程，即在两条不同区块链之间交换资产。参与的区块链各自锁定要交换的资产，然后解锁以接收另一条区块链的对应资产。

尽管这两种活动在概念上相似，但跨链资产转移和交换协议在技术实现和操作流程上存在显著差异，需要采用不同的方法和解决方案。例如，多种跨链交换协议（如 HTLC 及 [6,18,30] 中的方案）并不支持资产转移；而其他方案如公证方案和中继链（见第 3 节介绍），虽然具备同时支持跨链资产转移和交换的能力，却通常需要第三方实体的参与，这些实体拥有较大权限，从而带来集中式安全风险。

## 3 相关工作与动机

本节首先简要介绍跨链交互领域最相关的工作，然后通过详述被相关研究忽略的三个跨链隐私保护与审计挑战，阐明我们的设计动机与启示。

### 3.1 相关工作

当前最先进的跨链方案大体可分为链上方案（chain-based）和桥接方案（bridge-based）两类。链上方案，例如侧链 [28] 和哈希时间锁合约（HTLC）[31]，依托于区块链固有机制，无需额外实体。侧链是与母链协同运行的独立区块链。ZeroCross [21] 是基于 Monero 平台的隐私保护侧链解决方案；Zedoo [10] 则利用 zk-SNARK 技术实现了审计功能。Baldimtsi 等人 [1] 提出了一种连接匿名链的方案。HTLC 结合哈希锁与时间锁以支持跨链交换；XCLAIM [41] 缓解了原始 HTLC 框架中对并发在线的严格假设；Deshpande 等 [6] 基于 Schnorr 签名为 HTLC 增加了隐私保护；MAD-HTLC [31] 通过区块链激励机制有效抵御激励操纵攻击；Cross-Channel [15] 提升了基于 HTLC 的跨链系统吞吐量；Thyagarajan 等 [30] 则采用可验证定时签名替代时间锁。

桥接方案如公证方案 [40] 和中继链 [2]，则需第三方组件来促进链间交互。在公证方案中，可信第三方（公证人）负责验证跨链交易真实性，设计简单却存在单点故障风险。Yin 等 [40] 通过引入安全硬件与密码学技术增强了公证方案的安全性。中继链方案则引入专用区块链网络作为中继链，实现参与链之间的资产转移。zkBridge [36] 提出 Virgo 来提升跨链桥验证效率；Wang 等 [33] 提出“链治链”概念；BeDCV [44] 则采用监督链（supervision chain）进行去中心化审计，利用同态加密等技术。需要注意的是，桥接方案引入了公证人和中继链等可信机制，虽可同时支持跨链转移与交换，却存在单点故障风险；且其星型架构虽利于审计任务，却影响系统可扩展性。

### 3.2 跨链隐私保护与审计的挑战

尽管已有多种成熟的跨链解决方案，跨链隐私保护与审计领域仍面临显著挑战，主要包括跨链可关联性泄露问题（Cross-chain Linkability Exposure, CLE）、隐私与审计不兼容问题（Incompatibility of Privacy and Auditing, IPA）以及全面审计效率低下问题（Full Auditing Inefficiency, FAI）。以下分别阐述这三大挑战。

**挑战 1：CLE。**  

已有若干方案针对跨链隐私提出解决思路。例如，文献 [39,43] 的方案高度依赖特定应用场景；文献 [1,21] 借助底层区块链平台（如 Monero 和 Zcash）提供隐私保护，却与其他系统不兼容；Deshpande 等 [6] 针对跨链交换提出方案，但要求双方共享同一秘密作为前提，不适用于互不信任的参与者。综上，目前跨链隐私保护研究尚不充分，在通用性与安全性方面存隐忧；且现有工作往往试图用单一协议同时支持跨链转移与交换，却依赖第三方实体（如桥接方案），带来安全风险。解决 CLE 的关键在于：①准确区分不同跨链活动的特点；②采用灵活手段模糊交互双方关联；③杜绝引入任何可能破坏系统安全的第三方。

**挑战 2：IPA。**  

隐私保护与审计需求往往同时存在且目标相互冲突。截至目前，尚无跨链方案能兼顾两者。现有跨链隐私保护方案 [1,6,21,39,43] 在设计时未考虑审计支持，仅关注最小化信息泄露与协议完整性，忽略信息可验证性。在有权限区块链中，审计者通常为链外主体，无法访问链内交易信息。例如，在多家企业共建的多链系统中，内部节点频繁交互，而银行、保险公司等第三方机构承担审计职责，但无法获取内部数据（如收据、员工信息），导致审计受阻，进而影响贷款等业务。为有效解决此类问题，亟需在不泄露私密信息的前提下，借助公开可得数据实现对私密信息的验证。

**挑战 3：FAI。**  

现有审计方案可分为激励型和中继型两类。激励型方案（如 Polkadot 中的 fisherman [35]）通过激励机制让审计者选择性验证部分交易以获取奖励；中继型方案则依托实体或网络对所有交易进行全面审查以降低恶意风险 [33,44]。一般而言，中继型方案因全量审计（full auditing）具备更高安全性，但效率往往逊于激励型方案。具体而言，假设系统包含 $k$ 条区块链，且每条链在单位时间内平均处理 $n$ 笔交易，则中继型方案中每个审计节点的工作量可估计为 $O(k \times n)$ [35]，对审计者提出了高计算需求，导致验证效率低下；随着区块链数量不断增加，两类方案在审计效率上的局限将成为实际应用的障碍。由此，亟需设计一种审计者友好（auditor-friendly）的方案，既能保证安全与效率，又能实现全量审计。

**动机与启示。**  

基于以上观察，我们提出了包含三种协议的 zkCross 新型架构。相比第 3 节介绍的桥接方案，zkCross 采用树型结构设计，既兼顾隐私保护与审计需求，又降低跨链审计的中心化风险。在隐私保护协议设计方面，zkCross 利用 SPV（Simplified Payment Verification）[32] 和 HTLC（Hashed Timelock Contracts）[31] 两种去中心化跨链交互基础技术来实现跨链转移与交换；并进一步采用 zk-SNARKs、哈希函数与面额机制，全面解决包括接收方地址、预映像和交易金额在内的关联性破坏因素。在审计协议设计方面，zkCross 借助 zk-SNARKs 的简洁性，将复杂计算任务下沉至链下，从而提升链上审计效率。    

## 4 模型与预备知识

本节首先定义我们的网络模型与威胁模型。随后介绍构成 zkCross 基础的 zk-Rollup、哈希时间锁合约与简化支付验证。

### 4.1 模型

**网络模型。** 

zkCross 是一种配备三种协议的两层跨链架构。架构中的所有实体均为拥有区块链账户、能够进行链上和链下操作的真实用户。此外，每个实体可拥有多个账户，每个账户相当于区块链上的一个节点。

在 zkCross 中，下层包含多条相互独立的区块链（称为普通链），其中发起方（$S$）与接收方（$R$）之间存在跨链交易。普通链中的每个节点可担任提交者（$C_T$），负责汇总链上相关数据。我们假设每条普通链中至少存在一位诚实提交者 [36]。普通链可分为无权限链和有权限链：在无权限链中，所有实体均可注册账户并访问交易；而在有权限链中，外部节点（如上层的审计者）无法像在无权限链中那样自由访问交易。因此，我们假设审计者只能通过辅助手段（如 Gateways [25] 或区块链浏览器）获取有权限链的区块头，以在保护交易隐私的同时开展审计。

上层由审计链（audit chain）组成，包含两类节点：提交者和审计者。要将下层收集的链上数据上传至审计链并获取奖励，下层提交者需在审计链上注册账户，成为上层提交者。审计者（记为 $A_D$）负责审核上层提交者提交的数据。基于区块链的激励机制，诚实的上层提交者会获得相应奖励。审计链为无权限链，允许所有实体注册成为提交者节点。

**威胁模型。**  

节点在多项式时间内运行，可能在区块链网络中表现出拜占庭行为，但其投票权不得超过预设阈值，以维持共识安全 [15,30,31,36]。例如，在 PBFT（Practical Byzantine Fault Tolerance）中，拜占庭节点数必须低于总节点数的三分之一；在 PoW（Proof of Work）中，恶意节点算力不得超过网络总算力的 50%。

**设计目标。**  

为应对第 3.2 节中提出的挑战，zkCross 致力于实现以下目标：

- **隐私**：设 $S^L$ 与 $R^L$ 为一次跨链转移或交换中涉及的两个账户。zkCross 旨在保证二者之间的**不可关联性**（在定义 1 中形式化定义）。  
- **效率**：若跨链网络包含 $k$ 条普通链，每条链平均包含 $m$ 个区块，每个区块平均包含 $n$ 笔交易，则 zkCross 的审计效率复杂度为 $O(k \times m)$，相比传统的全量审计方案 $O(k \times m \times n)$ 大幅降低。

> **定义 1（不可关联性 [3,11,24]）。**  
>
> 对手无法将接收方账户与发送方发起的交易关联起来，反之亦然。

### 4.2 基于 zk-SNARK 的 zk-Rollup

zk-Rollup [38] 是一种区块链网络的扩容方案，其中“zk”代表“零知识（zero-knowledge）”。zk-SNARK [13] 是一种广泛应用于区块链中的零知识证明技术。以下定义基于 zk-SNARK 的 zk-Rollup；针对不同应用场景，也可用 deVigo [36] 等替代方案。

> **定义 2（基于 zk-SNARK 的 zk-Rollup）。**  
>
> zk-SNARK 要求实现一个 $F$-算术电路 $\Lambda$，用于强制约束公共输入 $\bar{x}$ 与私有输入（见证） $\bar{w}$ 之间的计算关系。基于 zk-SNARK 的 zk-Rollup 完整过程可形式化为包含三元多项式时间算法集 $\Pi = \{\text{Setup},\text{Prove},\text{Verify}\}$ .

- $crs \leftarrow Setup(1^\lambda,\Lambda)$

  在 zk-SNARK 中，算法接受安全参数 $1^\lambda$ 与电路 $\Lambda$ 作为输入，以生成通用参考字符串（crs），包括后续证明与验证所需的公钥与私钥对 $(pk,vk)$。在 zk-Rollup 中，电路中嵌入了所有交易签名与状态转移正确性的验证逻辑。

- $\pi \leftarrow Prove(pk,\bar{x},\bar{w})$
  
  在 zk-SNARK 中，算法接受证明密钥 $pk$、公共输入 $\bar{x}$ 与私有输入 $\bar{w}$ 以生成简洁的零知识证明 $\pi$；在实现 zk-Rollup 时，公共输入 $\bar{x}$ 包括转移金额和地址信息，私有输入 $\bar{w}$ 则为交易签名等数据。
  
- $1/0 \leftarrow Verify(vk,\bar{x},\pi)$
  
  在 zk-SNARK 与 zk-Rollup 中，算法使用验证密钥 $vk$ 与公共输入 $\bar{x}$ 对证明 $\pi$ 进行验证，输出 $1$ 表示验证成功，$0$ 表示验证失败。

> **注**：三元算法集 $\Pi$ 的具体实现可根据应用场景，通过调整参数 $\Lambda,\bar{x},\bar{w}$ 等灵活适配。

### 4.3 哈希时间锁合约

HTLC（Hashed TimeLock Contract）是闪电网络的关键技术，广泛应用于跨链交换 [31]。

**定义 3（跨链场景中的 HTLC）。**  

HTLC 协议要求交易双方 $S$ 与 $R$ 在各自区块链上均拥有账户。为便于说明，将双方在链 I 上的账户记为 $S^L$ 与 $R^L$，在链 II 上的账户记为 $S^I$ 与 $R^I$。协议包含三个阶段：

- **Lock：**  

  $S^L$ 选择一个随机密钥（例如 256 位整数）作为原像 pre，并计算哈希值 $h(\mathrm{pre})$。$S^L$ 在链 I 的智能合约 $\xi^I$ 中锁定要发送给 $R^I$ 的资产，并设置计时器 $T_1$。随后，$R^I$ 使用相同的 $h(\mathrm{pre})$ 在链 II 的智能合约 $\xi^{II}$ 中锁定要发送给 $S^L$ 的资产，并设置计时器 $T_2$，满足 $T_1 > T_2$。

- **Unlock：**  
  
  在时限 $T_2$ 内，$S^L$ 向链 I 的智能合约 $\xi^I$ 提供原像 pre，以解锁由 $R^I$ 锁定的资产。之后，$R^I$ 在时限 $T_1$ 内向智能合约 $\xi^{II}$ 提供 pre，从而解锁由 $S^L$ 锁定的资产。
  
- **Refund：**  
  
  若 $S^L$ 未能在 $T_2$ 时限内提供 pre，则链 II 上的 $\xi^{II}$ 中锁定的资产将退回给 $R^L$；若在 $T_1$ 超时后仍未完成互换，链 I 上的 $\xi^I$ 中资产将退回给 $S^L$。

> **注意：** 某些区块链系统（如比特币）不原生支持智能合约，可通过脚本等机制实现 HTLC [32]。本文中讨论 HTLC 时，“智能合约”一词指真实合约或脚本等实现技术。

### 4.4 简化支付验证

SPV（Simplified Payment Verification）由中本聪 [32] 于 2008 年提出，并被以太坊等多种区块链系统广泛采用。其旨在使轻客户端无需下载整个链上数据，便可通过 Merkle 证明参与区块链网络。具体而言，某笔交易的 Merkle 证明由该交易在 Merkle 树中的路径（所有兄弟节点的哈希值）与整个 Merkle 树的根节点共同构成，允许轻节点在不获取完整区块的情况下验证交易是否包含在该区块中。

## 5 zkCross

本节首先介绍 zkCross 的总体架构及优势，然后详细阐述为实现隐私保护审计而设计的三种协议。

### 5.1 概述

zkCross 针对 CLE、IPA 和 FAI 三大挑战提出解决方案。图 1 展示了其两层架构及三种关键协议。

<p style="text-align:center"><img src="./1.png" alt="bug"/></p>

<p style="text-align:center">图 1： zkCross 示意图：上层为审计链；下层为多条普通链；橙色框中标示了三种协议。</p>

下层由多条普通链组成，图 1 中标示为 Chain I、Chain II 和 Chain III。上层包含用于监管下层活动的审计链。在该架构中，每条区块链维护一个状态树，本质上为二叉 Merkle 树。在普通链中，状态树的每个叶子节点代表账户状态的哈希结果，包括公钥和余额；在审计链中，其状态树存储普通链的状态树根作为叶子，建立审计链与普通链之间的层级链接。

zkCross 包含两种隐私保护协议（Θ 和 Φ），分别针对两类跨链交互活动：转移与交换。参与者位于不同普通链上。例如，Chain I 的发送方 $S^L$ 可使用协议 Θ 将资产私密地转移至 Chain II 的接收方 $R^L$；Chain II 的发送方 $S^{II}$ 可通过协议 Φ 与 Chain III 的接收方 $R^{III}$ 完成跨链交换。Θ 和 Φ 可同时保护交互双方的隐私关系。审计链主要由审计者和提交者构成。在跨链审计协议 Ψ 下，提交者负责在普通链打包交易并提交给审计者以完成审计流程。

两层架构可支持多种实体间交互，如跨链参与实体与审计实体之间的交互，从而便于设计隐私保护跨链协议和高效审计协议。注意，该架构将审计 (Ψ) 与跨链协议 (Θ 与 Φ) 解耦，意味着可在不局限于隐私保护审计的场景下，采用 SPV、HTLC 等主流跨链技术，或根据具体需求对审计协议的审核内容进行定制，如验证交易金额是否在预设范围内，或检查交易是否在黑名单中。Ψ 可在不暴露下层交易信息的前提下完成审计。

### 5.2 隐私保护跨链协议

本小节介绍两种不同的隐私保护协议，以解决 CLE 问题。

#### 5.2.1 隐私保护跨链转移协议

在基于 SPV 的跨链转移过程中，接收方地址和转移金额是可能暴露交互双方关联性的两个关键因素。显然，需要隐藏转移的目标地址；同时，为保证跨链转移的原子性，也需隐藏转移金额。例如，考虑 Bitcoin 与 Ethereum 汇率为 1:10 的场景：在一次跨链转移中，比特币链上“燃烧” 1 BTC，并在以太坊链上“铸造”等价的 10 ETH。如果转移金额公开，攻击者可通过燃烧和铸造交易关联交互双方；然而，当地址和金额均被隐藏时，将导致 SPV 验证失败，从而破坏跨链交互的原子性。

<p style="text-align:center"><img src="./2.png" alt="bug"/></p>

<p style="text-align:center">图 2： 隐私保护跨链转移协议 Θ 流程。蓝色块表示交易 $\(\mathrm{Tx}_{\mathrm{Burn}}\)$ 的哈希摘要，红色块表示 Merkle 证明信息，即 $\(h_{\mathrm{Burn}}\)$ 与 $\(\mathrm{root}_{\mathrm{Burn}}\)$。
</p>

基于上述分析，我们设计了隐私保护跨链转移协议 Θ（见图 2），以解决接收方地址与转移金额泄露带来的隐私风险。我们选用 zk-SNARK 隐藏接收方公钥 $pk_{R^L}$，并通过设置固定面额 [12,16,29] 隐藏转移金额。例如，在以太坊链上，当基本面额设为 2 ETH，若 $S^L$ 意图向 $R^L$ 转移 6 ETH，则需执行三笔 2 ETH 的转移交易。此设计通过多笔交易掩盖具体转移金额，实现隐私保护。协议 Θ 的具体流程如下。

假设 Chain I 中的 $S^L$ 向 Chain II 中的 $R^L$ 转移金额 $v_S$，其中 $v_S$ 为标准面额。整个协议由四个步骤组成：Burn、Transmit、Mint 和 Redeem。注意在一次跨链转移中，Mint 和 Redeem 步骤只能执行其一：若执行 Mint，则表示转移成功；若执行 Redeem，则表示所转移的金额已退回发送方。

- **Θ.Burn：**  
  
  在此步骤中，$S^L$ 将交易 $\mathrm{Tx}_{\mathrm{Burn}}$ 发送至智能合约 $\xi^I$（或专用销毁账户）以“销毁”金额 $v_S$。交易 $\mathrm{Tx}_{\mathrm{Burn}}$ 包含转移金额 $v_S$ 以及通过对接收方公钥 $pk_{R^L}$、随机数 $r$ 和序列号 $sn$ 进行哈希后得到的摘要 $h(pk_{R^L},r,sn)$。在哈希函数中同时引入 $r$ 与 $sn$ 可以增强哈希结果的随机性，隐藏接收方信息 $pk_{R^L}$ 并防止暴力破解攻击 [19]。$r$ 与 $sn$ 可通过伪随机函数（PRF）[20] 生成；同时，$sn$ 作为跨链转移活动的唯一标识符（类似货币序列号）。一旦 $v_S$ 被认领，对应的 $sn$ 将被公开以防止双花攻击 [42]。智能合约在验证签名合法性及账户余额充足后，锁定 $v_S$ 并设置时锁 $T_3$。  
  $$
  \mathrm{Tx}_{\mathrm{Burn}} \overset{\mathrm{def}}{=} (\mathrm{From}:S;\ \mathrm{To}:\xi;\ v_S;\ h(pk_{R^L},r,sn)).
  $$
  上述设计确保对手仅能获知某节点发起了交易 $\mathrm{Tx}_{\mathrm{Burn}}$，却无法得知其接收方。
  
- **Θ.Transmit：**  
  
  达成共识后，交易 $\mathrm{Tx}_{\mathrm{Burn}}$ 的哈希摘要将作为叶子节点包含于 Chain I 的区块中。为简化描述，此处省略 Nonce、区块号等非核心字段。$\mathrm{Tx}_{\mathrm{Burn}}$ 的哈希摘要定义为：  
  $$
  h(\mathrm{Tx}_{\mathrm{Burn}}) \overset{\mathrm{def}}{=} \mathrm{hash}\bigl(pk^S,\mathrm{addr}_{R^L},v_S,\;h(pk_{R^L},r,sn)\bigr).
  $$
  随后，$S^L$ 通过链下通信将以下参数发送给 $R^L$：随机数 $r$、序列号 $sn$ 以及由一组哈希构成的 Merkle 证明 $h_{\mathrm{Burn}}$，其中 $h_{\mathrm{Burn}}$ 包含 Merkle 根 $\mathrm{root}_{\mathrm{Burn}}$ 与交易 $\mathrm{Tx}_{\mathrm{Burn}}$ 的 Merkle 路径。
